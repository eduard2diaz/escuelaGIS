/********************************************/
/*Proyecto: La Escuela Es Nuestra           */
/*Script para generar las tablas            */
/*Elaboro: Rocío Revilla Aquino				*/
/********************************************/

-- Table: leen.tipocondicion

-- DROP TABLE leen.tipocondicion;

CREATE TABLE leen.tipocondicion
(
    idtipocondicion smallint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 32767 CACHE 1 ),
    condicion character(50) COLLATE pg_catalog."default",
    sigla character varying(1) COLLATE pg_catalog."default",
    CONSTRAINT tipocondicion_pkey PRIMARY KEY (idtipocondicion)
)
WITH (
    OIDS = FALSE
)
TABLESPACE pg_default;

ALTER TABLE leen.tipocondicion
    OWNER to postgres;

GRANT ALL ON TABLE leen.tipocondicion TO postgres;

GRANT ALL ON TABLE leen.tipocondicion TO sa WITH GRANT OPTION;

-- Table: leen.tipocomprobante

-- DROP TABLE leen.tipocomprobante;

CREATE TABLE leen.tipocomprobante
(
    idtipocomprobante smallint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 32767 CACHE 1 ),
    comprobante character(200) COLLATE pg_catalog."default",
    "descripción" character(1000) COLLATE pg_catalog."default",
    fechacaptura date,
    idestatus smallint,
    CONSTRAINT tipocomprobante_pkey PRIMARY KEY (idtipocomprobante),
    CONSTRAINT estatus FOREIGN KEY (idestatus)
        REFERENCES leen.estatus (idestatus) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)
WITH (
    OIDS = FALSE
)
TABLESPACE pg_default;

ALTER TABLE leen.tipocomprobante
    OWNER to postgres;

GRANT ALL ON TABLE leen.tipocomprobante TO postgres;

GRANT ALL ON TABLE leen.tipocomprobante TO sa WITH GRANT OPTION;

-- Table: leen.tipocomprobante

-- DROP TABLE leen.tipocomprobante;

CREATE TABLE leen.tipocomprobante
(
    idtipocomprobante smallint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 32767 CACHE 1 ),
    comprobante character(200) COLLATE pg_catalog."default",
    "descripción" character(1000) COLLATE pg_catalog."default",
    fechacaptura date,
    idestatus smallint,
    CONSTRAINT tipocomprobante_pkey PRIMARY KEY (idtipocomprobante),
    CONSTRAINT estatus FOREIGN KEY (idestatus)
        REFERENCES leen.estatus (idestatus) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)
WITH (
    OIDS = FALSE
)
TABLESPACE pg_default;

ALTER TABLE leen.tipocomprobante
    OWNER to postgres;

GRANT ALL ON TABLE leen.tipocomprobante TO postgres;

GRANT ALL ON TABLE leen.tipocomprobante TO sa WITH GRANT OPTION;
-- Table: leen.codigopostal

-- DROP TABLE leen.codigopostal;

CREATE TABLE leen.codigopostal
(
    d_codigo character varying COLLATE pg_catalog."default",
    d_asenta character varying COLLATE pg_catalog."default",
    d_tipo_asenta character varying COLLATE pg_catalog."default",
    "D_mnpio" character varying COLLATE pg_catalog."default",
    d_estado character varying COLLATE pg_catalog."default",
    d_ciudad character varying COLLATE pg_catalog."default",
    "d_CP" character varying COLLATE pg_catalog."default",
    c_estado character varying COLLATE pg_catalog."default",
    c_oficina character varying COLLATE pg_catalog."default",
    "c_CP" character varying COLLATE pg_catalog."default",
    c_tipo_asenta character varying COLLATE pg_catalog."default",
    c_mnpio character varying COLLATE pg_catalog."default",
    id_asenta_cpcons character varying COLLATE pg_catalog."default",
    d_zona character varying COLLATE pg_catalog."default",
    idcodigo integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    c_cve_ciudad character varying COLLATE pg_catalog."default",
    CONSTRAINT codigopostal_pkey PRIMARY KEY (idcodigo)
)
WITH (
    OIDS = FALSE
)
TABLESPACE pg_default;

ALTER TABLE leen.codigopostal
    OWNER to postgres;
COMMENT ON TABLE leen.codigopostal
    IS 'Catalogo de código postal obtenido de SEPOMEX';
-- Table: leen.estatus

-- DROP TABLE leen.estatus;

CREATE TABLE leen.estatus
(
    idestatus smallint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 32767 CACHE 1 ),
    estatus character(250) COLLATE pg_catalog."default",
    CONSTRAINT estatus_pkey PRIMARY KEY (idestatus)
)
WITH (
    OIDS = FALSE
)
TABLESPACE pg_default;

ALTER TABLE leen.estatus
    OWNER to postgres;

GRANT ALL ON TABLE leen.estatus TO postgres;

GRANT ALL ON TABLE leen.estatus TO sa WITH GRANT OPTION;

COMMENT ON TABLE leen.estatus
    IS 'Catalógo de estatus de datos ';

    -- Table: leen.escuela

-- DROP TABLE leen.escuela;

CREATE TABLE leen.escuela
(
    idescuela integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    idplantel character(11) COLLATE pg_catalog."default",
    ccts character(80) COLLATE pg_catalog."default",
    escuela character(500) COLLATE pg_catalog."default",
    idcodigo integer,
    CONSTRAINT escuela_pkey PRIMARY KEY (idescuela)
)
WITH (
    OIDS = FALSE
)
TABLESPACE pg_default;

ALTER TABLE leen.escuela
    OWNER to postgres;

    -- Table: leen.direccion

-- DROP TABLE leen.direccion;

CREATE TABLE leen.direccion
(
    iddireccion integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    d_codigo integer NOT NULL,
    calle "char",
    numeroexterior integer,
    estado character varying COLLATE pg_catalog."default",
    municipio character varying COLLATE pg_catalog."default",
    localidad character varying COLLATE pg_catalog."default",
    CONSTRAINT direccion_pkey PRIMARY KEY (iddireccion)
)
WITH (
    OIDS = FALSE
)
TABLESPACE pg_default;

ALTER TABLE leen.direccion
    OWNER to postgres;

GRANT ALL ON TABLE leen.direccion TO postgres;

GRANT ALL ON TABLE leen.direccion TO sa WITH GRANT OPTION;

-- Table: leen.proyecto

-- DROP TABLE leen.proyecto;

CREATE TABLE leen.proyecto
(
    idproyecto integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    idescuela integer,
    fechainicio date,
    fechafinal date,
    montoasignado money,
    montogastado money,
    saldofinal money,
    CONSTRAINT proyecto_pkey PRIMARY KEY (idproyecto)
)
WITH (
    OIDS = FALSE
)
TABLESPACE pg_default;

ALTER TABLE leen.proyecto
    OWNER to postgres;

GRANT ALL ON TABLE leen.proyecto TO postgres;

GRANT ALL ON TABLE leen.proyecto TO sa WITH GRANT OPTION;

-- Table: leen.controlgasto

-- DROP TABLE leen.controlgasto;

CREATE TABLE leen.controlgasto
(
    idcontrolgastos integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    idproyecto integer,
    idtipocomprobante integer,
    fechacaptura date,
    concepto character(3000) COLLATE pg_catalog."default",
    numerocomprobante smallint,
    monto money,
    controlarchivos path,
    CONSTRAINT controlgasto_pkey PRIMARY KEY (idcontrolgastos),
    CONSTRAINT comprobante FOREIGN KEY (idtipocomprobante)
        REFERENCES leen.tipocomprobante (idtipocomprobante) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT proyecto FOREIGN KEY (idproyecto)
        REFERENCES leen.proyecto (idproyecto) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)
WITH (
    OIDS = FALSE
)
TABLESPACE pg_default;

ALTER TABLE leen.controlgasto
    OWNER to postgres;

GRANT ALL ON TABLE leen.controlgasto TO postgres;

GRANT ALL ON TABLE leen.controlgasto TO sa WITH GRANT OPTION;

COMMENT ON TABLE leen.controlgasto
    IS 'Control de gastos de las acciones realizadas en la escuela de acuerdo al plan de trabajo';


    -- Table: leen.condicioneducativaalumnos

-- DROP TABLE leen.condicioneducativaalumnos;

CREATE TABLE leen.condicioneducativaalumnos
(
    idcondicionalumnos integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    iddiagnostico integer,
    ccts character(10) COLLATE pg_catalog."default",
    numalumnas smallint,
    numalumnos smallint,
    grado smallint,
    CONSTRAINT condicioneducativaalumnos_pkey PRIMARY KEY (idcondicionalumnos),
    CONSTRAINT diagnostico FOREIGN KEY (iddiagnostico)
        REFERENCES leen.diagnosticoplantel (iddiagnosticoplantel) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)
WITH (
    OIDS = FALSE
)
TABLESPACE pg_default;

ALTER TABLE leen.condicioneducativaalumnos
    OWNER to postgres;

GRANT ALL ON TABLE leen.condicioneducativaalumnos TO postgres;

GRANT ALL ON TABLE leen.condicioneducativaalumnos TO sa WITH GRANT OPTION;



-- Table: leen.condicioneducativadocente

-- DROP TABLE leen.condicioneducativadocente;

CREATE TABLE leen.condicioneducativadocente
(
    idcondiciondocente integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    iddiagnostico integer,
    ccts character(10) COLLATE pg_catalog."default",
    curp character(18) COLLATE pg_catalog."default",
    nombre character(350) COLLATE pg_catalog."default",
    grado character(4) COLLATE pg_catalog."default",
    CONSTRAINT condicioneducativadocente_pkey PRIMARY KEY (idcondiciondocente),
    CONSTRAINT diagnostico FOREIGN KEY (iddiagnostico)
        REFERENCES leen.diagnosticoplantel (iddiagnosticoplantel) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)
WITH (
    OIDS = FALSE
)
TABLESPACE pg_default;

ALTER TABLE leen.condicioneducativadocente
    OWNER to postgres;

GRANT ALL ON TABLE leen.condicioneducativadocente TO postgres;

GRANT ALL ON TABLE leen.condicioneducativadocente TO sa WITH GRANT OPTION;

-- Table: leen.controlgasto

-- DROP TABLE leen.controlgasto;

CREATE TABLE leen.controlgasto
(
    idcontrolgastos integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    idproyecto integer,
    idtipocomprobante integer,
    fechacaptura date,
    concepto character(3000) COLLATE pg_catalog."default",
    numerocomprobante smallint,
    monto money,
    controlarchivos path,
    CONSTRAINT controlgasto_pkey PRIMARY KEY (idcontrolgastos),
    CONSTRAINT comprobante FOREIGN KEY (idtipocomprobante)
        REFERENCES leen.tipocomprobante (idtipocomprobante) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT proyecto FOREIGN KEY (idproyecto)
        REFERENCES leen.proyecto (idproyecto) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)
WITH (
    OIDS = FALSE
)
TABLESPACE pg_default;

ALTER TABLE leen.controlgasto
    OWNER to postgres;

GRANT ALL ON TABLE leen.controlgasto TO postgres;

GRANT ALL ON TABLE leen.controlgasto TO sa WITH GRANT OPTION;

COMMENT ON TABLE leen.controlgasto
    IS 'Control de gastos de las acciones realizadas en la escuela de acuerdo al plan de trabajo';
    -- Table: leen.diagnosticoplantel

-- DROP TABLE leen.diagnosticoplantel;

CREATE TABLE leen.diagnosticoplantel
(
    idproyecto integer,
    numeroaulas smallint,
    idcondicionaulas smallint,
    numerosanitarios smallint,
    idcondicionsanitarios smallint,
    numerooficinas smallint,
    idcondicionoficina smallint,
    numerobibliotecas smallint,
    indcondicionbiblioteca smallint,
    numeroaulasmedios smallint,
    idcondicionaulamedios smallint,
    numeropatio smallint,
    idcondicionpatio smallint,
    numerocanchasdeportivas smallint,
    idcondicioncanchasdeportivas smallint,
    numerobarda smallint,
    idcondicionbarda smallint,
    aguapotable bit(1),
    idcondicionagua smallint,
    drenaje bit(1),
    idcondiciondrenaje smallint,
    energiaelectrica bit(1),
    idcondicionenergia smallint,
    telefono bit(1),
    idcondiciotelefono smallint,
    internet bit(1),
    "idcondicióninternet" smallint,
    iddiagnosticoplantel integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    diagnosticoarchivo path,
    observacionesaulas character varying COLLATE pg_catalog."default",
    observacionessanitarios character varying COLLATE pg_catalog."default",
    observacionesoficinas character varying COLLATE pg_catalog."default",
    observacionesbiblioteca character varying COLLATE pg_catalog."default",
    observacionesaula character varying COLLATE pg_catalog."default",
    observacionespatio character varying COLLATE pg_catalog."default",
    observacionescanchas character varying COLLATE pg_catalog."default",
    observacionesbarda character varying COLLATE pg_catalog."default",
    obserbacionesagua character varying COLLATE pg_catalog."default",
    observacionesdrenaje character varying COLLATE pg_catalog."default",
    observacionesenergia character varying COLLATE pg_catalog."default",
    observacionestelefono character varying COLLATE pg_catalog."default",
    observacionesinternet character varying COLLATE pg_catalog."default",
    CONSTRAINT diagnosticoplantel_pkey PRIMARY KEY (iddiagnosticoplantel),
    CONSTRAINT proyecto FOREIGN KEY (idproyecto)
        REFERENCES leen.proyecto (idproyecto) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)
WITH (
    OIDS = FALSE
)
TABLESPACE pg_default;

ALTER TABLE leen.diagnosticoplantel
    OWNER to postgres;

GRANT ALL ON TABLE leen.diagnosticoplantel TO postgres;

GRANT ALL ON TABLE leen.diagnosticoplantel TO sa WITH GRANT OPTION;
-- Table: leen.plantrabajo

-- DROP TABLE leen.plantrabajo;

CREATE TABLE leen.plantrabajo
(
    idplantrabajo integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    idproyecto integer,
    idtipoaccion integer,
    fechacaptura date,
    descripcionaccion character(2000) COLLATE pg_catalog."default",
    tiempoestimado character(200) COLLATE pg_catalog."default",
    costoestimado money,
    totalderecursosasignados money,
    planarchivo path,
    CONSTRAINT plantrabajo_pkey PRIMARY KEY (idplantrabajo),
    CONSTRAINT accion FOREIGN KEY (idtipoaccion)
        REFERENCES leen.tipoaccion (idtipoaccion) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT proyecto FOREIGN KEY (idproyecto)
        REFERENCES leen.proyecto (idproyecto) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)
WITH (
    OIDS = FALSE
)
TABLESPACE pg_default;

ALTER TABLE leen.plantrabajo
    OWNER to postgres;

GRANT ALL ON TABLE leen.plantrabajo TO postgres;

GRANT ALL ON TABLE leen.plantrabajo TO sa WITH GRANT OPTION;

COMMENT ON TABLE leen.plantrabajo
    IS 'plan de trabajo de las escuelas que están en un proyecto';

    -- Table: leen.rendicioncuentas

-- DROP TABLE leen.rendicioncuentas;

CREATE TABLE leen.rendicioncuentas
(
    idrendidioncuentas integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    idproyecto integer,
    idtipoaccion integer,
    fechacaptura date,
    monto money,
    rendicionarchivos path,
    CONSTRAINT rendicioncuentas_pkey PRIMARY KEY (idrendidioncuentas),
    CONSTRAINT proyecto FOREIGN KEY (idproyecto)
        REFERENCES leen.proyecto (idproyecto) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT tipoaccion FOREIGN KEY (idtipoaccion)
        REFERENCES leen.tipoaccion (idtipoaccion) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)
WITH (
    OIDS = FALSE
)
TABLESPACE pg_default;

ALTER TABLE leen.rendicioncuentas
    OWNER to postgres;

GRANT ALL ON TABLE leen.rendicioncuentas TO postgres;

GRANT ALL ON TABLE leen.rendicioncuentas TO sa WITH GRANT OPTION;

COMMENT ON TABLE leen.rendicioncuentas
    IS 'Rendición de cuentas de las accoines conculidas en las escuela , monto gastado y el monto sobrante';